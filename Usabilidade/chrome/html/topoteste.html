<!-- ROTEIRO -->
<div id="USroteiro">
	<b class="USroteiroClose">X</b>
	<h3>Roteiro</h3>
	<p></p>
</div>
<!-- TOPO INSERIDO -->
<div id="USwebclient-topo-todo">
	<div id="USwebclient-topo">
	<div class="USdireita">
		<a class="USbotao USbotao-verde USconcluir USdisabled" id="concluir12qz3" href="#">Concluir</a>
	</div>
	<div class="UScentro" id="roteiroContent">
		<a class="USbotao fancybox" id="roteiro" href="#USroteiro">Roteiro</a>
	</div>
	<div class="USesquerda">
		<a class="USbotao USbotao-info">Bom</a> 
		<a class="USbotao USbotao-vermelho">Ruim</a>
		<a class="USbotao">Comentario</a>
	</div>
	</div>
</div>
<!-- BOTÃO SHOW TOPO -->
<a class="USbotao USbotao-info" id="USbuttonTopo">UseSkill</a>
<script>
	(function($){
		var domainUseSkill = "http://localhost:8080/Usabilidade";
		var $topo = $('#USwebclient-topo-todo');
		var vel = 400;
		var topoShow = false;
		var animateStoped = true;
		var heightTop = $topo.css("height").substr(0,2);
		var btnConcluir = "concluir12qz3";

		function getStorage(chave){			
			chrome.extension.sendRequest({useskill: "getStorage", key: chave}, function(response) {
  					console.log(response.dados);
			});
		}

		/*função para topo*/
		$('#USbuttonTopo').live({
			'click':function(e){
				e.preventDefault();
				var $this = $(this);
				if(topoShow){
					$topo.fadeToggle(vel, function(){
						$this.animate({
							top: '-='+heightTop
						},vel/2);
					});
					$this.html('UseSkill');
					//$b.attr("class", $b.attr("class").replace("minus","plus"));

					topoShow=false;
				}else{
					$this.animate({
						top: '+='+heightTop
					},vel/2,function(){
						$topo.fadeToggle(vel);
					});
					$this.html('Minimizar');
					topoShow=true;
				}
			}
		});

		/*método genérico para realizar ajax*/
		function ajax(caminho, tipo, dados){
			var retorno;
			$.ajax({
				url: caminho,
				cache: false,
				type: tipo,
				async: false,
				data: dados,
				success: function(dados){
					retorno = dados;
				},
				error: function(jqXHR, status, err){
					console.log(jqXHR);
				}
			});
			return retorno;
		}

		$(document).ready(function(){
				//iniciar fancybox e o plugin capt
				$('.fancybox').fancybox();
				$('.USroteiroClose').click(function(e){
					e.preventDefault();
					$('.fancybox-close').trigger('click')
				});

				$("#"+btnConcluir).click(function(e){
					alert(getStorage("listaElementos"));
					//ajax(domainUseSkill+"/tarefa/save/fluxo", "POST", "{ tarefaId: "++", dados: }");
				});


				//$.webclientCapt({'url': "${pageContext.request.contextPath}/tarefa/save/fluxo/usuario"});
				/*
				$('#roteiro').click(function(e){
					$.ajax({
							url : domainUseSkill+"/tarefa/roteiro",
							type : 'POST',
							dataType : 'json',
							async : false,
							data : {
								'idTarefa' : get_url_parameter("idTarefa")
								},
								success : function(json) {
									console.log("SUCCESS");
									$('#USroteiro').children('p').html(json.string);
									},
									error : function(jqXHR, textStatus, errorThrown){
										console.log("ERRO");
										}
									});
					});
		
				function get_url_parameter(param) {
					param = param.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
					var r1 = "[\\?&]" + param + "=([^&#]*)";
					var r2 = new RegExp(r1);
					var r3 = r2.exec(window.location.href);
					if (r3 == null)
						return "";
					else
						return r3[1];
				}
				*/
			});
	})(jQuery);
</script>